<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js element">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Teams Bridge - Element Documentation</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Documentation for Element and EMS by the EMS team">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../src/book-assets/element-theme.css">
        <link rel="stylesheet" href="../src/book-assets/font.css">
        <link rel="stylesheet" href="../src/book-assets/logo.css">
        <link rel="stylesheet" href="../src/book-assets/remove-nav-buttons.css">
        <link rel="stylesheet" href="../src/book-assets/style.css">
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "element";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('element')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../index.html">Element Docs</a></li><li class="chapter-item expanded "><a href="../Frequently-Asked-Questions.html">Frequently Asked Questions</a></li><li class="chapter-item expanded affix "><li class="part-title">Element Matrix Services</li><li class="chapter-item expanded "><a href="../Add-Additional-Users.html">Add Additional Users</a></li><li class="chapter-item expanded "><a href="../Add-Users.html">Add Users</a></li><li class="chapter-item expanded "><a href="../Client-Look-and-Feel.html">Client Look &amp; Feel</a></li><li class="chapter-item expanded "><a href="../EMS-Server-With-Custom-Domain.html">EMS Server With Custom Domain</a></li><li class="chapter-item expanded "><a href="../Get-Your-Own-EMS-Server.html">Get Your Own EMS Server</a></li><li class="chapter-item expanded "><a href="../Reset-User-Password.html">Reset User Password</a></li><li class="chapter-item expanded "><a href="../Migrate-From-Self-Hosted-to-EMS.html">Migrate From Self-Hosted to EMS</a></li><li class="chapter-item expanded "><a href="../Import-Database-and-Media-Dump.html">Import Database and Media Dump</a></li><li class="chapter-item expanded affix "><li class="part-title">Integrations</li><li class="chapter-item expanded "><a href="../Create-a-Conference-Call-in-a-Room.html">Create a Conference Call in a Room</a></li><li class="chapter-item expanded "><div>Authentication</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../authentication/Google-SAML.html">Google SAML</a></li><li class="chapter-item expanded "><a href="../authentication/LDAP-Active-Directory.html">LDAP Active Directory</a></li><li class="chapter-item expanded "><a href="../authentication/OpenID-Connect.html">OpenID Connect</a></li></ol></li><li class="chapter-item expanded "><div>EMS bridges</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../integrations/Discord-Bridge.html">Discord Bridge</a></li><li class="chapter-item expanded "><a href="../integrations/Signal-Bridge.html">Signal Bridge</a></li><li class="chapter-item expanded "><a href="../integrations/ems-Slack-Bridge.html">Slack Bridge</a></li><li class="chapter-item expanded "><a href="../integrations/Teams-Bridge.html" class="active">Teams Bridge</a></li><li class="chapter-item expanded "><a href="../integrations/Telegram-Bridge.html">Telegram Bridge</a></li><li class="chapter-item expanded "><a href="../integrations/WhatsApp-Bridge.html">WhatsApp Bridge</a></li></ol></li><li class="chapter-item expanded "><div>Matrix.org hosted bridges</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../integrations/morg-IRC-Bridge.html">Public IRC Bridges</a></li><li class="chapter-item expanded "><a href="../integrations/morg-Slack-Bridge.html">Public Slack Bridge</a></li></ol></li><li class="chapter-item expanded "><div>Extensions</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../integrations/Admin-Bot.html">Admin Bot</a></li><li class="chapter-item expanded "><a href="../integrations/Audit-Bot.html">Audit Bot</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Element</li><li class="chapter-item expanded "><a href="../Add-Email-to-Your-Account.html">Add Email to Your Account</a></li><li class="chapter-item expanded "><a href="../Change-Account-Password.html">Change Account Password</a></li><li class="chapter-item expanded "><a href="../Submit-Debug-Logs.html">Submit Debug Logs</a></li><li class="chapter-item expanded affix "><li class="part-title">Cross Signing</li><li class="chapter-item expanded "><a href="../Set-up-Cross-Signing.html">Set up Cross Signing</a></li><li class="chapter-item expanded "><a href="../Check-Status.html">Check Status</a></li><li class="chapter-item expanded "><a href="../Export-and-Import-E2E-Room-Keys.html">Export and Import E2E Room Keys</a></li><li class="chapter-item expanded "><a href="../Reset-Cross-Signing.html">Reset Cross Signing</a></li><li class="chapter-item expanded "><a href="../Verify-new-Login.html">Verify new Login</a></li><li class="chapter-item expanded affix "><li class="part-title">Non-English</li><li class="chapter-item expanded "><a href="../Nutzung-der-eigenen-Domain-mit-EMS.html">Deutsch: Nutzung der eigenen Domain mit EMS</a></li><li class="chapter-item expanded affix "><li class="part-title">Contribute</li><li class="chapter-item expanded "><a href="../Contribute.html">Contribute</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="element">Element (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        <img alt="Element logo" class="header-logo" src="">
                    </div>

                    <h1 class="menu-title">Element Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/vector-im/ems-docs" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/vector-im/ems-docs/edit/main/src/integrations/Teams-Bridge.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <h1 id="teams-bridge"><a class="header" href="#teams-bridge">Teams Bridge</a></h1>
<h2 id="introduction"><a class="header" href="#introduction">Introduction</a></h2>
<p>This guide explains how to set up a Teams bridge with your Element host. You will need to be an administrator of your Teams group to set the bridge up. Connecting to a Teams workspace that you do not control is currently not supported.</p>
<h2 id="setup"><a class="header" href="#setup">Setup</a></h2>
<p>The setup process requires fetching a few details from your Teams workspace.</p>
<h3 id="teams-link"><a class="header" href="#teams-link">Teams Link</a></h3>
<p><img src="/images/integrations/Teams-Bridge/get-link.png" alt="Get link to team item on the Team context menu" /></p>
<p>You can get the link to your team by copying it from the Teams interface. Pasting it into this form will bring up a button which will take you into the consent flow. Consenting to the form will allow Element to access your Team on Microsoft.</p>
<h3 id="bot-username-and-password"><a class="header" href="#bot-username-and-password">Bot Username and Password</a></h3>
<p>The bridge requires a Teams user to be registered as a <code>bot</code> to send messages on behalf of Matrix users. You just need to allocate one user from the Teams interface to do this.</p>
<ol>
<li>First, you must go to the <a href="https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview">Azure Active Directory page</a>.</li>
<li>Click users.</li>
<li>Click New user.</li>
<li>Ensure <code>Create user</code> is selected.
<ul>
<li>Enter a User name ex. <code>matrixbridge</code>.</li>
<li>Enter a Name ex. <code>Matrix Bridge</code>.</li>
<li>Enter an Initial password.</li>
<li>Create the user.</li>
<li>Optionally, set more profile details like an avatar.</li>
</ul>
</li>
<li>You will now need to log in as this new bot user to set a permanent password (Teams requires you to reset the password on login).</li>
<li>After logging in you should be prompted to set a new password.</li>
<li>Enter the bot username and password into the integration form.</li>
</ol>
<h3 id="welcome-room"><a class="header" href="#welcome-room">Welcome room</a></h3>
<p>Users can be automatically prompted to link their Teams account to their Element account when they join an Element workspace. Ticking the <strong>Send a welcome message to new users of the bridge</strong> checkbox will make the bridge bot user start a DM with any new joining Element users and let them know how to get connected. If you wish to disable this behavior, leave this box unchecked.</p>
<h3 id="max-teams-users"><a class="header" href="#max-teams-users">Max Teams users</a></h3>
<p>The bridge is billed based upon the number of participating Teams-side users, so you should set the maximum number of users you'd expect to see using the bridge to ensure your costs meet expectations. If the number of active Teams users exceeds this value, the bridge will be blocked, until you increase the limit. <strong>Whatever you set the limit to, you will only be charged for the number of remote users actively using the bridge.</strong></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../integrations/ems-Slack-Bridge.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../integrations/Telegram-Bridge.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../integrations/ems-Slack-Bridge.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../integrations/Telegram-Bridge.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="../src/book-assets/sidebar.js"></script>
    </body>
</html>
