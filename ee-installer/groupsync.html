<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js element">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Setting up Group Sync - Element Enterprise Installer Documentation - 0.6.1</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="src/book-assets/element-theme.css">
        <link rel="stylesheet" href="src/book-assets/font.css">
        <link rel="stylesheet" href="src/book-assets/logo.css">
        <link rel="stylesheet" href="src/book-assets/style.css">
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "element";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('element')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="introduction.html">Introduction</a></li><li class="chapter-item expanded "><a href="install-poc.html"><strong aria-hidden="true">1.</strong> How to Install a POC Environment</a></li><li class="chapter-item expanded "><a href="install-prod.html"><strong aria-hidden="true">2.</strong> How to Install a Production Environment</a></li><li class="chapter-item expanded "><a href="permalinks.html"><strong aria-hidden="true">3.</strong> Setting up Permalinks</a></li><li class="chapter-item expanded "><a href="jitsi.html"><strong aria-hidden="true">4.</strong> Setting up Jitsi</a></li><li class="chapter-item expanded "><a href="saml.html"><strong aria-hidden="true">5.</strong> Setting up SSO/SAML</a></li><li class="chapter-item expanded "><a href="groupsync.html" class="active"><strong aria-hidden="true">6.</strong> Setting up Group Sync</a></li><li class="chapter-item expanded "><a href="dimension.html"><strong aria-hidden="true">7.</strong> Setting Up the Integration Manager</a></li><li class="chapter-item expanded "><a href="hookshot.html"><strong aria-hidden="true">8.</strong> Setting up GitLab, GitHub, and JIRA Integrations</a></li><li class="chapter-item expanded affix "><a href="SUMMARY.html">Last Updated: April 4, 2022 at 8:30pm London Time</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="element">Element (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        <img alt="Element logo" class="header-logo" src="">
                    </div>

                    <h1 class="menu-title">Element Enterprise Installer Documentation - 0.6.1</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <h1 id="configuring-group-sync"><a class="header" href="#configuring-group-sync">Configuring Group Sync</a></h1>
<h2 id="what-is-group-sync"><a class="header" href="#what-is-group-sync">What is Group Sync?</a></h2>
<p>Group Sync allows you to use the ACLs from your identity infrastructure
in order to set up permissions on Spaces and Rooms in the Element
Ecosystem. Please note that the initial version we are providing
only supports a single node, non-federated configuration.</p>
<h2 id="general-settings"><a class="header" href="#general-settings">General settings</a></h2>
<ul>
<li>Copy sample file from <code>config-sample/groupsync/gsync.yml</code> to
<code>extra-config/groupsync</code></li>
<li>Edit the file with the following values :
<ul>
<li><code>ems_bridges_registry_username</code>: <code>ems bridges registry token name</code></li>
<li><code>ems_bridges_registry_password</code>: <code>ems bridges registry token password</code></li>
<li><code>group_power_levels</code> : A list of groups that'll determine people's
Matrix power levels. This affects only the space that the Group belongs
to – doesn't leak up or down. For MSGraph source, groups should be
identified by their ids. On LDAP, they should be identified by their names.</li>
<li><code>provisioner.dn_default_prefix</code>: Display names starting with this
prefix will get corrected according to the names we found for their
users in LDAP. Optional. Useful if you're using an OIDC provider that
doesn't give you users' display names.</li>
<li><code>provisioner.default_rooms</code> : Optional. A list of rooms that'll get
automatically created in in managed space. The ID is required to enable
GPS to track whether they were already created or not. You can change it,
but it'll cause new rooms to be generated.</li>
<li><code>provisioner.whitelisted_users</code> : Optional. A list of userid patterns
that will not get kicked from rooms even if they don't belong to them
according to LDAP. This is useful for things like the auditbot. Patterns
listed here will be wrapped in ^ and $ before matching.</li>
</ul>
</li>
</ul>
<h2 id="configuring-the-source"><a class="header" href="#configuring-the-source">Configuring the source</a></h2>
<h3 id="ldap-servers"><a class="header" href="#ldap-servers">LDAP Servers</a></h3>
<ul>
<li>You should create a ldap account with read access to the OUs containing
the users</li>
<li>This account should use password authentication</li>
<li>To use LDAP source, copy the file  <code>config-sample/groupsync/ldap.yml</code> to
<code>extra-config/groupsync</code> the following variables :
<ul>
<li><code>ldap_check_interval_seconds</code>: The interval check in seconds</li>
<li><code>ldap_uri</code>: The LDAP Uri to connect to the ldap server</li>
<li><code>ldap_base</code>: The LDAP base used to build the space hierarchy. This OU
will become the root space. Every OU below this base will be a child-space.</li>
<li><code>ldap_bind_dn</code>: The user bind dn to use to read the space hierarchy.</li>
<li><code>ldap_bind_password</code>: The user password</li>
<li><code>ldap_attrs_uid</code>: The attribute to use to map to users mxids</li>
<li><code>ldap_attrs_name</code>: The attribute to use to map to spaces names</li>
</ul>
</li>
<li>Restart the install script</li>
</ul>
<h3 id="ms-graph-azure-ad"><a class="header" href="#ms-graph-azure-ad">MS Graph (Azure AD)</a></h3>
<ul>
<li>
<p>You need to create an <code>App registration</code>. You'll need the <code>Tenant ID</code> of
the organization, the <code>Application (client ID)</code> and a secret generated from
<code>Certificates &amp; secrets</code> on the app.</p>
</li>
<li>
<p>For the bridge to be able to operate correctly, navigate to API permissions
and ensure it has access to Group.Read.All, GroupMember.Read.All and
User.Read.All</p>
</li>
<li>
<p>Remember to grant the admin consent for those.</p>
</li>
<li>
<p>To use MSGraph source, copy the file  <code>config-sample/groupsync/msgraph.yml</code>
to <code>extra-config/groupsync</code> the following variables :</p>
<ul>
<li><code>msgraph_tenant_id</code>: This is the &quot;Tenant ID&quot; from your Azure Active
Directory Overview</li>
<li><code>msgraph_client_id</code>: Register your app in &quot;App registrations&quot;. This
will be its &quot;Application (client) ID&quot;</li>
<li><code>msgraph_client_secret</code> : Go to &quot;Certificates &amp; secrets&quot;, and click
on &quot;New client secret&quot;. This will be the &quot;Value&quot; of the created secret
(not the &quot;Secret ID&quot;).</li>
</ul>
</li>
<li>
<p>Restart the install script</p>
</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="saml.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="dimension.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="saml.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="dimension.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
